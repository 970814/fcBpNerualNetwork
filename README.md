# 全连接神经网络

### 应用

##### 手写数字识别0～9

1. 使用mnist训练集
    - 训练集为50000张图片
    - 测试集为10000张图片
    
2. 达到的效果
   拟合度99.70%,测试集上 **准确率98.38%** ，在训练了28个epoth获得



### 算法细节

1. 使用反向传播算法计算梯度dw和db
   

   <img width="249" alt="4个基本方程" src="https://user-images.githubusercontent.com/19931702/110571270-46533a80-8192-11eb-8fc0-6975d421bae0.png">


2. 采用L2正则化
3. 采用随机梯度下降算法
    - min-batch大小为10
4. 使用fmincg高级优化算法执行梯度下降的单次迭代
5. 数据归一化
6. 参数初始化
    - 生成第l层的w和b，k为第l-1层的神经元个数
    - 使用方差为 1/k 的高斯分布生成w，方差为1 的高斯分布生成b
    - 这一定程度上加快了训练速度，详细联系作者
7. 对输出层采用softmax层，得到每个类别概率分布的输出







### 更多测试细节

**不同超参数得到的训练结果报告**
1. 未优化的bp神经网络
2. 优化算法改变 、将fminunc 改成fmincg
3. 参数随机初始化，使用方差为 1/k 的高斯分布生成w，方差为1 的高斯分布生成b
4. batchGD 改成 随机梯度下降
5. 数据归一化
6. [784 8 10] 修改为 [784 10 10]
7. [784 10 10] 修改为 [784 30 10], min-batch itertaion 1 增加到2
8. [784 30 10], min-batch itertaion 2 修改为1
9. 修改 cost 函数  为 分段计算 ;以消除0*inf=NaN问题。

10. [784 30 10] 修改为[784 40 10]
    - 训练集拟合度99.01%, 测试集准确率96.49%，在训练了39个epoth获得
11. 10得到结果图，train和test 在cost 和accuracy上的差距随着训练次数增大而增大，存在一定的过度拟合， 用L2正则化,lambda=0.01,[784 40 10] 修改为[784 48 10],   
    - 训练集拟合度93.42%, 测试集准确率93.79%，在训练了33个epoth获得
12. 11得到结果图,表明了具有较高的泛化能力，但存在一定的欠拟合， [784 48 10] 修改为[784 64 10]
    - 训练集拟合度93.77%, 测试集准确率94.25%，在训练了26个epoth获得
13. lambda=0.001                    
    - 训练集拟合度97.19%, 测试集准确率96.79%，在训练了36个epoth获得
14. [784 64 10] 修改为[784 90 10]    
    - 训练集拟合度97.47%, 测试集准确率96.94%，在训练了23个epoth获得
15. [784 90 10] 修改为[784 100 10]   
    - 训练集拟合度97.43%, 测试集准确率97.13%，在训练了54个epoth获得
16. [784 100 10] 修改为[784 200 10]  
    - 训练集拟合度97.36%, 测试集准确率97.22%，在训练了47个epoth获得
17. lambda=0.00005                  
    - 训练集拟合度99.05%, 测试集准确率97.98%，在训练了18个epoth获得
18. lambda=0.000001                 
    - 训练集拟合度99.71%, 测试集准确率98.08%，在训练了23个epoth获得
19. [784 200 10] 修改为[784 256 10]  
    - 训练集拟合度99.66%, 测试集准确率98.23%，在训练了17个epoth获得
20. lambda=0.00001                  
    - 训练集拟合度99.48%, 测试集准确率98.16%，在训练了22个epoth获得
21. [784 256 10] 修改为[784 300 10]  
    - 训练集拟合度99.61%, 测试集准确率98.24%，在训练了40个epoth获得
22. lambda=0.0000001                
    - 训练集拟合度99.86%, 测试集准确率98.32%，在训练了28个epoth获得
23. [784 300 10] 修改为[784 800 10]  
    - 训练集拟合度99.70%, 测试集准确率98.38%，在训练了28个epoth获得
24. [784 800 10] 修改为[784 200 10] lambda=0.00000001  
    - 训练集拟合度99.93%, 测试集准确率98.24%，在训练了50个epoth获得 
25. 添加 softmax 层 
    - 训练集拟合度99.78%, 测试集准确率98.27%，在训练了30个epoth获得
26. 详细数据报告联系作者


